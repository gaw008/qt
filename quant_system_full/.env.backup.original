# === Unicode Encoding Configuration ===
# Fix Unicode encoding issues on Windows console
PYTHONIOENCODING=utf-8

# === AI API ===
GEMINI_API_KEY=AAIzaSyBt_8fxUrg1K18MPRc9a-hA6tTWUbN3BrY

# === AI Training Configuration ===
# Enable daily AI model training after market close
ENABLE_DAILY_AI_TRAINING=true
# AI training frequency: daily, weekly, monthly
AI_TRAINING_FREQUENCY=daily
# AI model type for training: lightgbm, xgboost, neural_network
AI_MODEL_TYPE=lightgbm
# AI training target metric: sharpe_ratio, returns, win_rate
AI_TARGET_METRIC=sharpe_ratio
# AI training data source: yahoo_api, tiger, auto
AI_DATA_SOURCE=yahoo_api
# AI weight in selection (0.0-1.0): how much to trust AI vs traditional
AI_SELECTION_WEIGHT=0.4
# AI weight in trading signals (0.0-1.0): how much to trust AI vs traditional signals
AI_TRADING_WEIGHT=0.6
# Minimum training data days required
AI_MIN_TRAINING_DAYS=30
# Auto-retrain when performance drops below threshold
AI_AUTO_RETRAIN_THRESHOLD=0.3

# === Server Configuration ===
# API Server settings
API_PORT=8000
API_HOST=0.0.0.0
FRONTEND_PORT=3000
WEBSOCKET_PORT=8001
STREAMLIT_PORT=8501

# CORS configuration (comma-separated origins)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://localhost:8080

# === Path Configuration ===
# Use relative paths when possible (will be resolved automatically)
# PRIVATE_KEY_PATH=private_key.pem  # Relative to project root
# Use absolute path only if needed:
# PRIVATE_KEY_PATH=C:/quant_system_v2/quant_system_full/private_key.pem

# === Bot / TradeUP SDK ===
TIGER_ID=20550012
ACCOUNT=41169270          # 建议先用 paper account
PRIVATE_KEY_PATH=C:/quant_system_v2/quant_system_full/private_key.pem
SECRET_KEY=
TIMEZONE=US/Eastern
LANG=en_US
DRY_RUN=false            # 设置为false启用Tiger API真实交易

# === Data Source Configuration ===
# Options: "tiger", "yahoo_api", "yahoo_mcp", "auto" 
# "auto" priority: yahoo_api -> yahoo_mcp -> tiger -> placeholder
DATA_SOURCE=auto

# === Yahoo Finance API Settings ===
# Direct API access (recommended for production)
YAHOO_API_TIMEOUT=15.0
YAHOO_API_RETRIES=3
YAHOO_API_RETRY_DELAY=2.0

# === Yahoo Finance MCP Settings ===
# Enable MCP tools for enhanced market data access (alternative to direct API)
USE_MCP_TOOLS=true
# Optional: Yahoo Finance MCP proxy URL for better reliability
# YAHOO_MCP_PROXY_URL=http://127.0.0.1:7890

# === Market Configuration ===
# Primary market for trading (US or CN)
PRIMARY_MARKET=US
# Secondary markets (comma-separated)
SECONDARY_MARKETS=
# Market data timezone
MARKET_DATA_TIMEZONE=US/Eastern

# === Selection Strategy Configuration ===
# Default selection strategy (value_momentum, technical_breakout, earnings_momentum)
DEFAULT_SELECTION_STRATEGY=value_momentum
# Enable streaming selection mode (true/false) - provides real-time results and memory efficiency
STREAMING_MODE=true
# Path to CSV file with stock symbols (relative to project root)
STOCK_UNIVERSE_FILE=all_stock_symbols.csv
# Universe size for stock selection - Reduced to 500 for testing
SELECTION_UNIVERSE_SIZE=500
# Number of stocks to select - Keep at 20 for focused portfolio
SELECTION_RESULT_SIZE=20
# Minimum score threshold
SELECTION_MIN_SCORE=0.0

# === ML + Traditional Hybrid Configuration ===
# Enable ML+Traditional hybrid signals (true/false) - ACTIVATED!
USE_HYBRID_SIGNALS=true
# ML signal weight in hybrid approach (0.0-1.0, higher = more ML influence)
ML_SIGNAL_WEIGHT=0.7
# Minimum ML confidence threshold (0.0-1.0)
ML_CONFIDENCE_THRESHOLD=0.6
# Enable GPU acceleration for ML models
USE_GPU_ACCELERATION=true
# GPU models directory path
GPU_MODELS_DIR=gpu_models

# === Task Scheduling Configuration ===
# Selection tasks interval (seconds) - runs during market closed (increased for 30K analysis)
SELECTION_TASK_INTERVAL=3600
# Trading tasks interval (seconds) - runs during market hours (reduced for faster execution)
TRADING_TASK_INTERVAL=15
# Monitoring tasks interval (seconds) - runs continuously
MONITORING_TASK_INTERVAL=60
# Recovery tasks interval (seconds) - system health checks
RECOVERY_TASK_INTERVAL=300

# === Stock Universe Filtering ===
# Path to CSV file with stock universe - UPGRADED to 5000+ stocks from NASDAQ+NYSE
STOCK_UNIVERSE_FILE=C:/quant_system_v2/quant_system_full/all_stock_symbols.csv
# Universe size for stock selection - Reduced to 500 for testing
SELECTION_UNIVERSE_SIZE=500
# Sectors to exclude (comma-separated)
EXCLUDE_SECTORS=
# Sectors to include (comma-separated, if empty includes all)
INCLUDE_SECTORS=
# Market cap filters (USD) - Relaxed for broader universe coverage
MIN_MARKET_CAP=100000000
MAX_MARKET_CAP=5000000000000
# Volume and price filters - Relaxed for comprehensive universe
MIN_DAILY_VOLUME=50000
MIN_STOCK_PRICE=1.0
MAX_STOCK_PRICE=2000.0

# === 30K Universe Performance Configuration ===
# Batch processing settings for handling 30K stocks efficiently
BATCH_SIZE=20
MAX_CONCURRENT_REQUESTS=5
REQUEST_DELAY=2.0
MAX_RETRIES=5

# === Fallback Strategy Configuration ===
# Enable fallback stocks when selection fails
USE_FALLBACK_STOCKS=true
# Fallback strategy: selection_error (yesterday's success) or emergency (large-cap tech)
FALLBACK_STRATEGY=selection_error
# Maximum number of fallback stocks to use
MAX_FALLBACK_STOCKS=15
# Minimum score for fallback stocks  
MIN_FALLBACK_SCORE=75.0
# Log fallback usage for monitoring
LOG_FALLBACK_USAGE=true
TIMEOUT_PER_BATCH=300

# === Dashboard ===
ADMIN_TOKEN=wgyjd0508               # 请在生产中改为强口令
API_BASE=http://localhost:8000
# === Improvement System Configuration ===
# Enable improvement system modules
ENABLE_IMPROVEMENT_SYSTEM=true

# === Trading Cost Modeling ===
# Enable transaction cost modeling
ENABLE_COST_MODELING=true
# Enable cost optimization in live trading
ENABLE_COST_OPTIMIZATION=true
# Cost thresholds in basis points
COST_HIGH_THRESHOLD_BPS=30
COST_MEDIUM_THRESHOLD_BPS=15
# Default slippage rate (basis points)
DEFAULT_SLIPPAGE_BP=5.0
# Market impact parameters
MARKET_IMPACT_LINEAR_COEFF=0.1
MARKET_IMPACT_SQRT_COEFF=0.5
# ADV participation rate limit (% of daily volume)
MAX_ADV_PARTICIPATION=0.05
# Commission rates (USD per share)
COMMISSION_RATE_USD=0.005

# === Portfolio Risk Management ===
# Enable portfolio optimization
ENABLE_PORTFOLIO_OPTIMIZATION=true
# Risk model type: ledoit_wolf, sample, constant_correlation
RISK_MODEL_TYPE=ledoit_wolf
# Maximum portfolio volatility (annualized)
MAX_PORTFOLIO_VOLATILITY=0.20
# Maximum single position weight
MAX_POSITION_WEIGHT=0.10
# Minimum position weight
MIN_POSITION_WEIGHT=0.01
# Sector concentration limits
MAX_SECTOR_WEIGHT=0.30
# Risk-free rate (annualized)
RISK_FREE_RATE=0.045

# === Execution Robustness ===
# Enable order management system
ENABLE_OMS=true
# Order retry attempts
MAX_ORDER_RETRIES=3
# Order timeout (seconds)
ORDER_TIMEOUT=30
# Circuit breaker thresholds
DAILY_LOSS_LIMIT=0.05
POSITION_LOSS_LIMIT=0.15
# Order validation checks
ENABLE_ORDER_VALIDATION=true
# Pre-trade risk checks
ENABLE_PRETRADE_RISK=true

# === MLflow Experiment Tracking ===
# Enable MLflow tracking
ENABLE_MLFLOW=true
# MLflow tracking URI
MLFLOW_TRACKING_URI=http://localhost:5000
# MLflow experiment name
MLFLOW_EXPERIMENT_NAME=quant_trading_improvements
# MLflow artifact location
MLFLOW_ARTIFACT_ROOT=./mlruns
# Auto-log parameters and metrics
MLFLOW_AUTO_LOG=true

# === Monitoring and Alerting ===
# Enable Prometheus metrics
ENABLE_PROMETHEUS=true
# Prometheus pushgateway URL
PROMETHEUS_PUSHGATEWAY_URL=http://localhost:9091
# Metrics collection interval (seconds)
METRICS_COLLECTION_INTERVAL=60
# Enable email alerts
ENABLE_EMAIL_ALERTS=false
# Alert thresholds
ALERT_DRAWDOWN_THRESHOLD=0.10
ALERT_VOLATILITY_THRESHOLD=0.25
ALERT_ERROR_RATE_THRESHOLD=0.05

# === Backtesting and Validation ===
# Enable backtesting framework
ENABLE_BACKTESTING=true
# Backtest data directory
BACKTEST_DATA_DIR=./backtest_data
# Time series cross-validation parameters
TSCV_N_SPLITS=5
TSCV_TEST_SIZE=252
# Purged K-Fold parameters
PURGE_GAP_DAYS=5
# Deflated Sharpe Ratio parameters
DSR_CONFIDENCE_LEVEL=0.95
DSR_FREQUENCY=252

# === Performance Analytics ===
# Enable performance attribution
ENABLE_PERFORMANCE_ATTRIBUTION=true
# Factor model for attribution
ATTRIBUTION_FACTOR_MODEL=fama_french_5
# Benchmark symbol for comparison
BENCHMARK_SYMBOL=SPY
# Performance calculation frequency
PERFORMANCE_CALC_FREQUENCY=daily

# === Market Regime Detection ===
# Enable regime detection
ENABLE_REGIME_DETECTION=true
# Regime detection method: hmm, threshold, volatility
REGIME_DETECTION_METHOD=hmm
# HMM number of states
HMM_N_STATES=3
# Volatility lookback window (days)
VOLATILITY_WINDOW=21
